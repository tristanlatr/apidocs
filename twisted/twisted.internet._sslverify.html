<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  

  <head>
    
    <title>twisted.internet._sslverify</title>
    <meta name="generator" content="pydoctor 22.2.2.dev0"> 
        
    </meta>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=0.75" />
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="apidocs.css" />
    <link rel="stylesheet" type="text/css" href="extra.css" />
</head>

  <body>

    <div style="display: none" id="current-docs-container" class="container">
  <div class="col-sm-12">
    <a id="current-docs-link">
      Go to the latest version of this document.
    </a>
  </div>
</div>

    <nav class="navbar navbar-default">
  
  <div class="container">

    <div class="navbar-header">
      
      <div class="navlinks">
        <span class="navbar-brand">
          <a href="https://twistedmatrix.com/" class="projecthome">Twisted</a> <a href="index.html">API Documentation</a>
        </span>

        <a href="moduleIndex.html">
          Modules
        </a>

        <a href="classIndex.html">
          Classes
        </a>

        <a href="nameIndex.html">
          Names
        </a>

        <div id="search-box-container">
          <div class="input-group">
            <input id="search-box" type="search" name="search-query" placeholder="Search..." aria-label="Search" minlength="2" class="form-control" autocomplete="off" />
            
            <span class="input-group-btn">
              <a style="display: none;" class="btn btn-default" id="search-clear-button" title="Clear" onclick="clearSearch()"><img src="fonts/x-circle.svg" alt="Clear" /></a>
              <a class="btn btn-default" id="search-help-button" title="Help" onclick="toggleSearchHelpText()"><img src="fonts/info.svg" alt="Help" /></a>
            </span>
          </div>
        </div>

      </div>

      <div id="search-results-container" style="display: none;">
        <div>
          <span class="label label-default" id="search-docstrings-button">
            <a title="Search in docstrings" onclick="toggleSearchInDocstrings()">search in docstrings</a></span>
        </div>

        <noscript>
            <h1>Cannot search: JavaScript is not supported/enabled in your browser.</h1>
        </noscript>

        <div class="hint" id="search-help-box">
          <p class="rst-last">
      
            Search bar offers the following options:
            <ul>   
                <li>
                  <strong>Term presence.</strong> The below example searches for documents that 
                    must contain “foo”, might contain “bar” and must not contain “baz”: <code>+foo bar -baz</code>
                </li> 

                <li>
                  <strong>Wildcards.</strong> The below example searches for documents with words beginning with “foo”: <code>foo*</code>
                </li> 

                <li>
                  <strong>Search in specific fields.</strong> The following search matches all objects 
                  in "twisted.mail" that matches “search”: <code>+qname:twisted.mail.* +search</code>

                  <p>
                    Possible fields: 'name', 'qname' (fully qualified name), 'docstring', and 'kind'.
                    Last two fields are only applicable if "search in docstrings" is enabled.
                  </p>
                </li>

                <li>
                  <strong>Fuzzy matches.</strong> The following search matches all documents 
                  that have a word within 1 edit distance of “foo”: <code>foo~1</code>
                </li>
            </ul>

          </p>
        </div>

        <div id="search-status"> </div>
        
        <div class="warning" id="search-warn-box" style="display: none;">
          <p class="rst-last"><span id="search-warn"></span></p>
        </div>

        <table id="search-results">
          <!-- Filled dynamically by JS -->
        </table>
        
        <div style="margin-top: 8px;">
          <p>Results provided by <a href="https://lunrjs.com">Lunr.js</a></p>
        </div>
      </div>

    </div>
  </div>

  <script src="ajax.js" type="text/javascript"></script>
  <script src="search.js" type="text/javascript"></script>

</nav>

    

    <div class="container">

      <div class="page-header">
        <h1 class="module private"><code><code><a href="index.html" class="internal-link">twisted</a></code><wbr></wbr>.<code><a href="twisted.internet.html" class="internal-link" title="twisted.internet">internet</a></code><wbr></wbr>.<code><a href="twisted.internet._sslverify.html" class="internal-link" title="twisted.internet._sslverify">_sslverify</a></code></code></h1>
        <div id="showPrivate">
          <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
        </div>
      </div>

      <div class="categoryHeader">
        module documentation
      </div>

      <div class="extrasDocstring">
        <a href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py" class="sourceLink">(source)</a>
        <p></p>
      </div>

      

      <div class="moduleDocstring">
        <div><p class="undocumented">Undocumented</p></div>
      </div>

      <div id="splitTables">
        <table class="children sortable" id="id661">
  
  
  <tr class="interface">
    
    <td>Interface</td>
    <td><code><a href="twisted.internet._sslverify.IOpenSSLTrustRoot.html" class="internal-link" title="twisted.internet._sslverify.IOpenSSLTrustRoot">​IOpen​SSLTrust​Root</a></code></td>
    <td>Trust settings for an OpenSSL context.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet._sslverify.CertBase.html" class="internal-link" title="twisted.internet._sslverify.CertBase">​Cert​Base</a></code></td>
    <td>Base class for public (certificate only) and private (certificate + key pair) certificates.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet._sslverify.ClientTLSOptions.html" class="internal-link" title="twisted.internet._sslverify.ClientTLSOptions">​Client​TLSOptions</a></code></td>
    <td>Client creator for TLS.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet._sslverify.OpenSSLCertificateAuthorities.html" class="internal-link" title="twisted.internet._sslverify.OpenSSLCertificateAuthorities">​Open​SSLCertificate​Authorities</a></code></td>
    <td>Trust an explicitly specified set of certificates, represented by a list of <code><a href="https://pyopenssl.readthedocs.io/en/stable/api/crypto.html#OpenSSL.crypto.X509" class="intersphinx-link">OpenSSL.crypto.X509</a></code> objects.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet._sslverify.OpenSSLCipher.html" class="internal-link" title="twisted.internet._sslverify.OpenSSLCipher">​Open​SSLCipher</a></code></td>
    <td>A representation of an OpenSSL cipher.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet._sslverify.PublicKey.html" class="internal-link" title="twisted.internet._sslverify.PublicKey">​Public​Key</a></code></td>
    <td>A <code><a href="twisted.internet._sslverify.PublicKey.html" class="internal-link" title="twisted.internet._sslverify.PublicKey">PublicKey</a></code> is a representation of the public part of a key pair.</td>
  </tr><tr class="class">
    
    <td>Class</td>
    <td><code><a href="twisted.internet._sslverify.SimpleVerificationError.html" class="internal-link" title="twisted.internet._sslverify.SimpleVerificationError">​Simple​Verification​Error</a></code></td>
    <td>Not a very useful verification error.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#simpleVerifyHostname" class="internal-link" title="twisted.internet._sslverify.simpleVerifyHostname">simple​Verify​Hostname</a></code></td>
    <td>Check only the common name in the certificate presented by the peer and only for an exact match.</td>
  </tr><tr class="function">
    
    <td>Function</td>
    <td><code><a href="#simpleVerifyIPAddress" class="internal-link" title="twisted.internet._sslverify.simpleVerifyIPAddress">simple​Verify​IPAddress</a></code></td>
    <td>Always fails validation of IP addresses</td>
  </tr><tr class="variable">
    
    <td>Variable</td>
    <td><code><a href="#defaultCiphers" class="internal-link" title="twisted.internet._sslverify.defaultCiphers">default​Ciphers</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="variable">
    
    <td>Variable</td>
    <td><code><a href="#verifyHostname" class="internal-link" title="twisted.internet._sslverify.verifyHostname">verify​Hostname</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="variable">
    
    <td>Variable</td>
    <td><code><a href="#verifyIPAddress" class="internal-link" title="twisted.internet._sslverify.verifyIPAddress">verify​IPAddress</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="class private">
    
    <td>Class</td>
    <td><code><a href="twisted.internet._sslverify._ChooseDiffieHellmanEllipticCurve.html" class="internal-link" title="twisted.internet._sslverify._ChooseDiffieHellmanEllipticCurve">_​Choose​Diffie​Hellman​Elliptic​Curve</a></code></td>
    <td>Chooses the best elliptic curve for Elliptic Curve Diffie-Hellman key exchange, and provides a <tt class="rst-docutils literal">configureECDHCurve</tt> method to set the curve, when appropriate, on a new <code><a href="https://pyopenssl.readthedocs.io/en/stable/api/ssl.html#OpenSSL.SSL.Context" class="intersphinx-link">OpenSSL.SSL.Context</a></code>.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_expandCipherString" class="internal-link" title="twisted.internet._sslverify._expandCipherString">_expand​Cipher​String</a></code></td>
    <td>Expand <tt class="rst-docutils literal">cipherString</tt> according to <tt class="rst-docutils literal">method</tt> and <tt class="rst-docutils literal">options</tt> to a tuple of explicit ciphers that are supported by the current platform.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_getExcludedTLSProtocols" class="internal-link" title="twisted.internet._sslverify._getExcludedTLSProtocols">_get​Excluded​TLSProtocols</a></code></td>
    <td>Given a pair of <code><a href="twisted.internet.ssl.TLSVersion.html" class="internal-link" title="twisted.internet.ssl.TLSVersion">TLSVersion</a></code> constants, figure out what versions we want to disable (as OpenSSL is an exclusion based API).</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_handleattrhelper" class="internal-link" title="twisted.internet._sslverify._handleattrhelper">_handleattrhelper</a></code></td>
    <td><span class="undocumented">No summary</span></td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_selectCiphers" class="internal-link" title="twisted.internet._sslverify._selectCiphers">_select​Ciphers</a></code></td>
    <td>Caclulate the acceptable list of ciphers from the ciphers we want and the ciphers we have support for.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_selectVerifyImplementation" class="internal-link" title="twisted.internet._sslverify._selectVerifyImplementation">_select​Verify​Implementation</a></code></td>
    <td>Determine if <tt class="rst-docutils literal">service_identity</tt> is installed. If so, use it. If not, use simplistic and incorrect checking as implemented in <code><a href="#simpleVerifyHostname" class="internal-link" title="twisted.internet._sslverify.simpleVerifyHostname">simpleVerifyHostname</a></code>.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_setAcceptableProtocols" class="internal-link" title="twisted.internet._sslverify._setAcceptableProtocols">_set​Acceptable​Protocols</a></code></td>
    <td>Called to set up the <code><a href="https://pyopenssl.readthedocs.io/en/stable/api/ssl.html#OpenSSL.SSL.Context" class="intersphinx-link">OpenSSL.SSL.Context</a></code> for doing NPN and/or ALPN negotiation.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_tolerateErrors" class="internal-link" title="twisted.internet._sslverify._tolerateErrors">_tolerate​Errors</a></code></td>
    <td>Wrap up an <tt class="rst-docutils literal">info_callback</tt> for pyOpenSSL so that if something goes wrong the error is immediately logged and the connection is dropped if possible.</td>
  </tr><tr class="function private">
    
    <td>Function</td>
    <td><code><a href="#_usablePyOpenSSL" class="internal-link" title="twisted.internet._sslverify._usablePyOpenSSL">_usable​Py​Open​SSL</a></code></td>
    <td>Check pyOpenSSL version string whether we can use it for host verification.</td>
  </tr><tr class="variable private">
    
    <td>Variable</td>
    <td><code><a href="#_defaultCurveName" class="internal-link" title="twisted.internet._sslverify._defaultCurveName">_default​Curve​Name</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="variable private">
    
    <td>Variable</td>
    <td><code><a href="#_tlsDisableFlags" class="internal-link" title="twisted.internet._sslverify._tlsDisableFlags">_tls​Disable​Flags</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="variable private">
    
    <td>Variable</td>
    <td><code><a href="#_x509names" class="internal-link" title="twisted.internet._sslverify._x509names">_x509names</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr>
</table>
        

          
      </div>

      <div id="childList">

        <div class="basefunction">
  
  
  <a name="twisted.internet._sslverify.simpleVerifyHostname">
    
  </a>
  <a name="simpleVerifyHostname">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">simpleVerifyHostname</span>(connection, hostname):
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L92">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Check only the common name in the certificate presented by the peer and only for an exact match.</p>
<p>This is to provide <em>something</em> in the way of hostname verification to users who haven't installed <tt class="rst-docutils literal">service_identity</tt>. This check is overly strict, relies on a deprecated TLS feature (you're supposed to ignore the commonName if the subjectAlternativeName extensions are present, I believe), and lots of valid certificates will fail.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">connection:</span><code><a href="https://pyopenssl.readthedocs.io/en/stable/api/ssl.html#OpenSSL.SSL.Connection" class="intersphinx-link">OpenSSL.SSL.Connection</a></code></td><td class="fieldArgDesc">the OpenSSL connection to verify.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">hostname:</span><code><a href="twisted.python.compat.html#unicode" class="internal-link" title="twisted.python.compat.unicode">unicode</a></code></td><td class="fieldArgDesc">The hostname expected by the user.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Raises</td></tr><tr><td class="fieldArgContainer"><code><a href="twisted.internet.ssl.html#VerificationError" class="internal-link">twisted.internet.ssl.VerificationError</a></code></td><td>if the common name and hostname don't match.</td></tr></table></div>
  </div>
</div><div class="basefunction">
  
  
  <a name="twisted.internet._sslverify.simpleVerifyIPAddress">
    
  </a>
  <a name="simpleVerifyIPAddress">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">simpleVerifyIPAddress</span>(connection, hostname):
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L117">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div>Always fails validation of IP addresses<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">connection:</span><code><a href="https://pyopenssl.readthedocs.io/en/stable/api/ssl.html#OpenSSL.SSL.Connection" class="intersphinx-link">OpenSSL.SSL.Connection</a></code></td><td class="fieldArgDesc">the OpenSSL connection to verify.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">hostname:</span><code><a href="twisted.python.compat.html#unicode" class="internal-link" title="twisted.python.compat.unicode">unicode</a></code></td><td class="fieldArgDesc">The hostname expected by the user.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Raises</td></tr><tr><td class="fieldArgContainer"><code><a href="twisted.internet.ssl.html#VerificationError" class="internal-link">twisted.internet.ssl.VerificationError</a></code></td><td>Always raised</td></tr></table></div>
  </div>
</div><div class="basevariable">
  
  
  <a name="twisted.internet._sslverify.defaultCiphers">
    
  </a>
  <a name="defaultCiphers">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">defaultCiphers</span> =
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L1840">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="basevariable">
  
  
  <a name="twisted.internet._sslverify.verifyHostname">
    
  </a>
  <a name="verifyHostname">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">verifyHostname</span> =
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L185">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="basevariable">
  
  
  <a name="twisted.internet._sslverify.verifyIPAddress">
    
  </a>
  <a name="verifyIPAddress">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">verifyIPAddress</span> =
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L185">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="basefunction private">
  
  
  <a name="twisted.internet._sslverify._expandCipherString">
    
  </a>
  <a name="_expandCipherString">
    
  </a>
  <div class="functionHeader">
    @<a href="https://docs.python.org/3/library/functools.html#functools.lru_cache" class="intersphinx-link">lru_cache</a>(<wbr></wbr>maxsize=32)<br />
    <span class="py-keyword">def</span> <span class="py-defname">_expandCipherString</span>(cipherString, method, options):
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L1728">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div>Expand <tt class="rst-docutils literal">cipherString</tt> according to <tt class="rst-docutils literal">method</tt> and <tt class="rst-docutils literal">options</tt> to a tuple of explicit ciphers that are supported by the current platform.<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">cipher​String:</span><code><a href="twisted.python.compat.html#unicode" class="internal-link" title="twisted.python.compat.unicode">unicode</a></code></td><td class="fieldArgDesc">An OpenSSL cipher string to expand.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">method</span></td><td class="fieldArgDesc">An OpenSSL method like <tt class="rst-docutils literal">SSL.TLSv1_METHOD</tt> used for determining the effective ciphers.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">options:</span><code><a href="https://docs.python.org/3/library/functions.html#int" class="intersphinx-link">int</a></code></td><td class="fieldArgDesc">OpenSSL options like <tt class="rst-docutils literal">SSL.OP_NO_SSLv3</tt> ORed together.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code><a href="https://docs.python.org/3/library/stdtypes.html#tuple" class="intersphinx-link">tuple</a></code> of <code><a href="twisted.internet.interfaces.ICipher.html" class="internal-link" title="twisted.internet.interfaces.ICipher">ICipher</a></code></td><td class="fieldArgDesc">The effective list of explicit ciphers that results from the arguments on the current platform.</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="twisted.internet._sslverify._getExcludedTLSProtocols">
    
  </a>
  <a name="_getExcludedTLSProtocols">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_getExcludedTLSProtocols</span>(oldest, newest):
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L62">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div>Given a pair of <code><a href="twisted.internet.ssl.TLSVersion.html" class="internal-link" title="twisted.internet.ssl.TLSVersion">TLSVersion</a></code> constants, figure out what versions we want to disable (as OpenSSL is an exclusion based API).<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">oldest:</span><code><a href="twisted.internet.ssl.TLSVersion.html" class="internal-link" title="twisted.internet.ssl.TLSVersion">TLSVersion</a></code> constant</td><td class="fieldArgDesc">The oldest <code><a href="twisted.internet.ssl.TLSVersion.html" class="internal-link" title="twisted.internet.ssl.TLSVersion">TLSVersion</a></code> we want to allow.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">newest:</span><code><a href="twisted.internet.ssl.TLSVersion.html" class="internal-link" title="twisted.internet.ssl.TLSVersion">TLSVersion</a></code> constant or <code><a href="https://docs.python.org/3/library/constants.html#None" class="intersphinx-link">None</a></code></td><td class="fieldArgDesc">The newest <code><a href="twisted.internet.ssl.TLSVersion.html" class="internal-link" title="twisted.internet.ssl.TLSVersion">TLSVersion</a></code> we want to allow, or <code><a href="https://docs.python.org/3/library/constants.html#None" class="intersphinx-link">None</a></code> for no upper limit.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code> of <code><a href="twisted.internet.ssl.TLSVersion.html" class="internal-link" title="twisted.internet.ssl.TLSVersion">TLSVersion</a></code> constants.</td><td class="fieldArgDesc">The versions we want to disable.</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="twisted.internet._sslverify._handleattrhelper">
    
  </a>
  <a name="_handleattrhelper">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_handleattrhelper</span>(Class, transport, methodName):
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L406">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div>(private) Helper for <code><a href="twisted.internet.ssl.Certificate.html#peerFromTransport" class="internal-link" title="twisted.internet.ssl.Certificate.peerFromTransport">Certificate.peerFromTransport</a></code> and <code><a href="twisted.internet.ssl.Certificate.html#hostFromTransport" class="internal-link" title="twisted.internet.ssl.Certificate.hostFromTransport">Certificate.hostFromTransport</a></code> which checks for incompatible handle types and null certificates and raises the appropriate exception or returns the appropriate certificate object.</div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="twisted.internet._sslverify._selectCiphers">
    
  </a>
  <a name="_selectCiphers">
    
  </a>
  <div class="functionHeader">
    @<a href="https://docs.python.org/3/library/functools.html#functools.lru_cache" class="intersphinx-link">lru_cache</a>(<wbr></wbr>maxsize=128)<br />
    <span class="py-keyword">def</span> <span class="py-defname">_selectCiphers</span>(wantedCiphers, availableCiphers):
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L1770">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div>Caclulate the acceptable list of ciphers from the ciphers we want and the ciphers we have support for.<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">wanted​Ciphers:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#tuple" class="intersphinx-link">tuple</a></code> of <code><a href="twisted.internet._sslverify.OpenSSLCipher.html" class="internal-link" title="twisted.internet._sslverify.OpenSSLCipher">OpenSSLCipher</a></code></td><td class="fieldArgDesc">The ciphers we want to use.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">available​Ciphers:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#tuple" class="intersphinx-link">tuple</a></code> of <code><a href="twisted.internet._sslverify.OpenSSLCipher.html" class="internal-link" title="twisted.internet._sslverify.OpenSSLCipher">OpenSSLCipher</a></code></td><td class="fieldArgDesc">The ciphers we have available to use.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code><a href="https://docs.python.org/3/library/stdtypes.html#tuple" class="intersphinx-link">tuple</a></code> of <code><a href="twisted.internet._sslverify.OpenSSLCipher.html" class="internal-link" title="twisted.internet._sslverify.OpenSSLCipher">OpenSSLCipher</a></code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="twisted.internet._sslverify._selectVerifyImplementation">
    
  </a>
  <a name="_selectVerifyImplementation">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_selectVerifyImplementation</span>():
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L145">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div>Determine if <tt class="rst-docutils literal">service_identity</tt> is installed. If so, use it. If not, use simplistic and incorrect checking as implemented in <code><a href="#simpleVerifyHostname" class="internal-link" title="twisted.internet._sslverify.simpleVerifyHostname">simpleVerifyHostname</a></code>.<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code><a href="https://docs.python.org/3/library/stdtypes.html#tuple" class="intersphinx-link">tuple</a></code></td><td class="fieldArgDesc">2-tuple of (<tt class="rst-docutils literal">verify_hostname</tt>, <tt class="rst-docutils literal">VerificationError</tt>)</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="twisted.internet._sslverify._setAcceptableProtocols">
    
  </a>
  <a name="_setAcceptableProtocols">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_setAcceptableProtocols</span>(context, acceptableProtocols):
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L1974">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div>Called to set up the <code><a href="https://pyopenssl.readthedocs.io/en/stable/api/ssl.html#OpenSSL.SSL.Context" class="intersphinx-link">OpenSSL.SSL.Context</a></code> for doing NPN and/or ALPN negotiation.<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">context:</span><code><a href="https://pyopenssl.readthedocs.io/en/stable/api/ssl.html#OpenSSL.SSL.Context" class="intersphinx-link">OpenSSL.SSL.Context</a></code></td><td class="fieldArgDesc">The context which is set up.</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">acceptable​Protocols:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#list" class="intersphinx-link">list</a></code> of <code><a href="https://docs.python.org/3/library/stdtypes.html#bytes" class="intersphinx-link">bytes</a></code></td><td class="fieldArgDesc">The protocols this peer is willing to speak after the TLS negotiation has completed, advertised over both ALPN and NPN. If this argument is specified, and no overlap can be found with the other peer, the connection will fail to be established. If the remote peer does not offer NPN or ALPN, the connection will be established, but no protocol wil be negotiated. Protocols earlier in the list are preferred over those later in the list.</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="twisted.internet._sslverify._tolerateErrors">
    
  </a>
  <a name="_tolerateErrors">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_tolerateErrors</span>(wrapped):
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L1047">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div><p>Wrap up an <tt class="rst-docutils literal">info_callback</tt> for pyOpenSSL so that if something goes wrong the error is immediately logged and the connection is dropped if possible.</p>
<p>This wrapper exists because some versions of pyOpenSSL don't handle errors from callbacks at <em>all</em>, and those which do write tracebacks directly to stderr rather than to a supplied logging system.  This reports unexpected errors to the Twisted logging system.</p>
<p>Also, this terminates the connection immediately if possible because if you've got bugs in your verification logic it's much safer to just give up.</p>
<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">wrapped:</span><code><a href="https://docs.python.org/3/library/functions.html#callable" class="intersphinx-link">callable</a></code></td><td class="fieldArgDesc">A valid <tt class="rst-docutils literal">info_callback</tt> for pyOpenSSL.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code><a href="https://docs.python.org/3/library/functions.html#callable" class="intersphinx-link">callable</a></code></td><td class="fieldArgDesc">A valid <tt class="rst-docutils literal">info_callback</tt> for pyOpenSSL that handles any errors in <tt class="rst-docutils literal">wrapped</tt>.</td></tr></table></div>
  </div>
</div><div class="basefunction private">
  
  
  <a name="twisted.internet._sslverify._usablePyOpenSSL">
    
  </a>
  <a name="_usablePyOpenSSL">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-keyword">def</span> <span class="py-defname">_usablePyOpenSSL</span>(version):
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L132">
      
      (source)
    </a>
  </div>
  <div class="docstring functionBody">
    
    
    <div>Check pyOpenSSL version string whether we can use it for host verification.<table class="fieldTable"><tr class="fieldStart"><td class="fieldName" colspan="2">Parameters</td></tr><tr><td class="fieldArgContainer"><span class="fieldArg">version:</span><code><a href="https://docs.python.org/3/library/stdtypes.html#str" class="intersphinx-link">str</a></code></td><td class="fieldArgDesc">A pyOpenSSL version string.</td></tr><tr class="fieldStart"><td class="fieldName" colspan="2">Returns</td></tr><tr><td class="fieldArgContainer"><code><a href="https://docs.python.org/3/library/functions.html#bool" class="intersphinx-link">bool</a></code></td><td class="fieldArgDesc"><span class="undocumented">Undocumented</span></td></tr></table></div>
  </div>
</div><div class="basevariable private">
  
  
  <a name="twisted.internet._sslverify._defaultCurveName">
    
  </a>
  <a name="_defaultCurveName">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_defaultCurveName</span>: <code><a href="https://docs.python.org/3/library/stdtypes.html#str" class="intersphinx-link">str</a></code> =
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L1847">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="basevariable private">
  
  
  <a name="twisted.internet._sslverify._tlsDisableFlags">
    
  </a>
  <a name="_tlsDisableFlags">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_tlsDisableFlags</span> =
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L50">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="basevariable private">
  
  
  <a name="twisted.internet._sslverify._x509names">
    
  </a>
  <a name="_x509names">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_x509names</span>: <code><a href="https://docs.python.org/3/library/stdtypes.html#dict" class="intersphinx-link">dict</a>[<wbr></wbr><a href="https://docs.python.org/3/library/stdtypes.html#str" class="intersphinx-link">str</a>, <wbr></wbr><a href="https://docs.python.org/3/library/stdtypes.html#str" class="intersphinx-link">str</a>]</code> =
    <a class="sourceLink" href="https://github.com/twisted/twisted/tree/twisted-21.2.0/src/twisted/internet/_sslverify.py#L243">
      
      (source)
    </a>
  </div>
  <div class="functionBody">
    
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div>

      </div>
    </div>

    <footer class="navbar navbar-default">
  

  <div class="container">
    <a href="index.html">API Documentation</a> for <a href="https://twistedmatrix.com/" class="projecthome">Twisted</a>,
  generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a>
    22.2.2.dev0 at 2022-03-04 05:57:20.
  </div>

  <!-- Google analytics, obviously. -->
  <script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
  <script type="text/javascript">
    _uacct = "UA-99018-6";
    urchinTracker();
  </script>

  <!-- If the documentation isn't current, insert a current link. -->
  <script type="text/javascript">
    if (window.location.pathname.indexOf('/current/') == -1) {
      <!-- Give the user a link to this page, but in the current version of the docs. -->
      var link = document.getElementById('current-docs-link');
      link.href = window.location.pathname.replace(/\/\d+\.\d+\.\d+\/api\//, '/current/api/');
      <!-- And make it visible -->
      var container = document.getElementById('current-docs-container');
      container.style.display = "";
      delete link;
      delete container;
    }
  </script>
</footer>

    <script src="pydoctor.js" type="text/javascript"></script>

  </body>
</html>